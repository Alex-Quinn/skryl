.chart#sleep_chart
- content_for(:javascript) do
  javascript:
    var sleepChartCategories = [#{@sleep_count.map{|k, v| "'#{ k.strftime("%b %d") }'"}.join(', ')}];
    var sleepChartData       = [#{@sleep_count.map{|k, v| v}.join(', ')}];
    var sleepChartWakeupData = [#{@wakeup_time.map{|k, v| v}.join(', ')}];

  coffee:
    $ ->
       chart = new Highcharts.Chart
          chart:
            renderTo: 'sleep_chart'
          title:
            text: "Total Sleep and Wakeup Time"
          xAxis:
            categories: sleepChartCategories
            labels:
              rotation: -45
              align: 'right'
              step: 2
          yAxis: [
            {
              labels: { enabled: false }
              minorGridLineWidth: 0
              gridLineWidth: 0
              min: 0
              title:
                text: null
            },
            {
              labels: { enabled: false }
              minorGridLineWidth: 0
              gridLineWidth: 0
              min: 0
              opposite: true
              title:
                text: null
            } ]
          tooltip:
            formatter: ->
              (if this.series.name == 'sleep' then (this.y + ' hours') else (Math.floor(this.y) + ':' + ('0' + Math.floor(this.y * 60 % 60)).slice(-2) + 'am') + ' on ' + this.x)
          series: [
            { name: 'sleep', data: sleepChartData, type: 'spline'},
            { name: 'wakeup', data: sleepChartWakeupData, yAxis: 1, type: 'spline', lineWidth: 1, dashStyle: 'Dash', states: { hover: { lineWidth: 2 } } }
          ]
